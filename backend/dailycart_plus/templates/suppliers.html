{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/suppliers.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <h1>🥕 Supplier Marketplace</h1>

    {% if message %}
        <div class="confirm-msg">{{ message }}</div>
    {% endif %}

    {% if suppliers %}
        {% for supplier in suppliers %}
        <div class="supplier-card">
            <div class="supplier-header">
                <h2>{{ supplier.name }} <span class="location">📍 {{ supplier.location }}</span></h2>
            </div>
            <p><strong>Ingredients Supplied:</strong> {{ supplier.ingredients | join(', ') }}</p>
            <p><strong>Trust Score:</strong>
                {% if supplier.trust_score == 'Not rated' %}
                    <span class="not-rated">Not rated yet</span>
                {% else %}
                    {{ supplier.trust_score }} / 5 ⭐
                {% endif %}
            </p>

            <form class="rating-form" method="POST" action="{{ url_for('supplier.rate_supplier', supplier_id=supplier.id, vendor_id=vendor_id) }}">
                <label for="rating-{{ supplier.id }}">Rate this Supplier:</label>
                <select name="rating" id="rating-{{ supplier.id }}" required>
                    <option value="" disabled selected>Rate (1–5)</option>
                    {% for i in range(1,6) %}
                    <option value="{{ i }}">{{ i }}</option>
                    {% endfor %}
                </select>
                <button type="submit">Submit Rating</button>
            </form>
        </div>
        {% endfor %}
    {% else %}
        <p class="empty-msg">😔 No suppliers found.</p>
    {% endif %}

    <div class="nav-buttons">
        <a href="{{ url_for('vendor.show_basket', vendor_id=vendor_id) }}">🧺 My Basket</a>
        <a href="{{ url_for('vendor.view_subscriptions', vendor_id=vendor_id) }}">📦 My Subscriptions</a>
        <a href="{{ url_for('vendor.view_history', vendor_id=vendor_id) }}">📜 History</a>
    </div>
</div>
{% endblock %}
